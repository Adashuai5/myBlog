<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT">





  <link rel="alternate" href="/rss2.xml" title="Ada 的个人博客主页" type="application/atom+xml">






<meta name="description" content="当然我也在扯淡。。">
<meta name="keywords" content="前端开发">
<meta property="og:type" content="website">
<meta property="og:title" content="Ada 的个人博客主页">
<meta property="og:url" content="http://adashuai5.com/page/2/index.html">
<meta property="og:site_name" content="Ada 的个人博客主页">
<meta property="og:description" content="当然我也在扯淡。。">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Ada 的个人博客主页">
<meta name="twitter:description" content="当然我也在扯淡。。">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://adashuai5.com/page/2/">




<link href="//cdn.bootcss.com/animate.css/3.5.0/animate.min.css" rel="stylesheet">
  <title>Ada 的个人博客主页</title>
  








</head>

<body itemscope="" itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope="" itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Ada 的个人博客主页</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">试问谁可，洁白无比？</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://adashuai5.com/2018/08/20/一次性理解立即执行函数和闭包/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Zhou Yuanda">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Ada 的个人博客主页">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/08/20/一次性理解立即执行函数和闭包/" itemprop="url">一次性理解立即执行函数和闭包</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-08-20T00:29:46+08:00">
                2018-08-20
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2018/08/20/一次性理解立即执行函数和闭包/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="/2018/08/20/一次性理解立即执行函数和闭包/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  1.2k
                </span>
              

              

              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Immediately-Invoked-Function-Expression（IIFE）：立即调用函数表达式"><a href="#Immediately-Invoked-Function-Expression（IIFE）：立即调用函数表达式" class="headerlink" title="Immediately-Invoked Function Expression（IIFE）：立即调用函数表达式"></a>Immediately-Invoked Function Expression（IIFE）：立即调用函数表达式</h1><p><strong>使用全局变量可能会造成一些不必要的麻烦<br>因此我们要使用局部变量</strong></p>
<p>在 java 语言中我们可以用 {  } 将代码包裹起来，使它们成为局部变量<br>但是这在 ES5 中不行，因为 var 有变量提升<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  var a = 1;</span><br><span class="line">&#125;</span><br><span class="line">// 上面代码等同于</span><br><span class="line">var a </span><br><span class="line">&#123;</span><br><span class="line">  a = 1;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><strong>ES6 里面引入了 let 的概念，于是有了块级作用域</strong><br>解决了这个问题，IIFE 似乎就变得不那么必要了<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  let a = 1;</span><br><span class="line">&#125;</span><br><span class="line">a </span><br><span class="line">// Uncaught ReferenceError: a is not defined</span><br></pre></td></tr></table></figure></p>
<p>但是了解 IIFE 可以让我们初学者更好得理解函数表达式、变量提升等的概念，以及了解前端语言的发展进程，知道前人一步步将原本不那么美好的 js 变得规范化的过程，学习他们的智慧。</p>
<p><strong>ES5 里面，没有块级作用域，只有函数（函数作用域）可提供局部变量环境</strong><br>于是我们声明一个 function xxx，然后 xxx.call()<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">function xxx()&#123;</span><br><span class="line">  var a = 1;</span><br><span class="line">&#125;.call()</span><br></pre></td></tr></table></figure></p>
<p>但是这个时候 xxx 也是全局变量（全局函数）<br>所以我们不能给这个函数名字，即需要使用<strong>匿名函数</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">function()&#123;</span><br><span class="line">  var a = 1;</span><br><span class="line">&#125;.call()</span><br><span class="line">// Uncaught SyntaxError: Unexpected token (</span><br></pre></td></tr></table></figure></p>
<p>但是这在 Chrome 里会报错，js 语法错误</p>
<p><strong>这是由于浏览器认为这是一个函数声明<br>解决办法：让浏览器去解析这个函数表达式</strong><br>如给函数取反<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">! function()&#123;</span><br><span class="line">  var a = 1;</span><br><span class="line">&#125;.call() </span><br><span class="line">// 我们不在乎这个匿名函数的返回值，所以加个 ! 取反没关系</span><br></pre></td></tr></table></figure></p>
<p>类似的还有<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">+function()&#123;&#125;()</span><br><span class="line">-function()&#123;&#125;()</span><br><span class="line">~function()&#123;&#125;()</span><br><span class="line">void function()&#123;&#125;()</span><br><span class="line">new function()&#123;&#125;()</span><br><span class="line">// function()&#123;&#125;() === function()&#123;&#125;.call()</span><br><span class="line">//用 .call() 更清楚</span><br></pre></td></tr></table></figure></p>
<p>如果实在不想改变函数返回值，也可以用圆括号<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">(function()&#123;&#125;).call() </span><br><span class="line">(function()&#123;&#125;.call())</span><br></pre></td></tr></table></figure></p>
<p>但是方法会有不好的情况：如果括号前面有东西<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">a</span><br><span class="line">(function()&#123;&#125;).call() </span><br><span class="line">//等价于</span><br><span class="line">a().call() </span><br><span class="line">//这不是我们想要的</span><br><span class="line">//同理</span><br><span class="line">a</span><br><span class="line">(function()&#123;&#125;.call())</span><br><span class="line">//等价于</span><br><span class="line">a()</span><br></pre></td></tr></table></figure></p>
<p>所以不推荐</p>
<p>你也可以用一个随机变量名函数而不用匿名函数，永远都不会变量污染的那种变量（这种方法好吗？）<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">function ada231231284u3lkda()&#123;</span><br><span class="line">  var a = 1;</span><br><span class="line">&#125;.call()</span><br></pre></td></tr></table></figure></p>
<p><strong>当然最推荐的还是用取反 ！，这就好像是个警示：我要开始用 IIFE 了</strong></p>
<hr>
<p><strong>IIFE 达到了局部变量的效果，外面访问不到立即执行函数里面的变量（避免变量污染）</strong></p>
<p><strong>但有时候我们需要访问 IIFE 里面的内容，怎么办？</strong><br>最简单的方法是直接用全局变量 window<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">! function()&#123;</span><br><span class="line">  var a = window.a = &#123;</span><br><span class="line">    n: 1</span><br><span class="line">  &#125;</span><br><span class="line">&#125;.call() </span><br><span class="line">// 另一个立即执行函数通过 window.a 访问</span><br><span class="line">! function()&#123;</span><br><span class="line">  var b = window.a</span><br><span class="line">  console.log(a)</span><br><span class="line">&#125;.call() // &#123;n: 1&#125;</span><br></pre></td></tr></table></figure></p>
<p><strong>我们还可以在 IIFE 里面使用闭包来隐藏 a</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">! function()&#123;</span><br><span class="line">  var a = &#123;</span><br><span class="line">    n: 1</span><br><span class="line">  &#125;</span><br><span class="line">  // 声明一个匿名函数保存于 window.nAdd1 </span><br><span class="line">  window.nAdd1 = function()&#123;</span><br><span class="line">    a.n += 1</span><br><span class="line">    // return 新的 a.n</span><br><span class="line">    return a.n</span><br><span class="line">  &#125;</span><br><span class="line">&#125;.call() </span><br><span class="line">// 匿名函数可以操作函数外面的变量 a ，这就是闭包</span><br><span class="line">// 另一个立即执行函数通过 window 访问</span><br><span class="line">! function()&#123;</span><br><span class="line">  var b = window.nAdd1()</span><br><span class="line">  console.log(newN)</span><br><span class="line">&#125;.call() // 2</span><br></pre></td></tr></table></figure></p>
<p><strong>IIFE 使得 a 成为局部变量而无法被外部访问<br>闭包使得匿名函数可以操作 a<br>window.nAdd1 保存了匿名函数的地址<br>任何地方都可以使用 window.nAdd1<br>=&gt; 任何地方都可以使用 window.nAdd1 操作 a，但是不能直接访问 a<br>这就是 window 和闭包联合作用的效果</strong></p>
<h1 id="闭包"><a href="#闭包" class="headerlink" title="闭包"></a>闭包</h1><p>将上面代码整合在一起，就是闭包的常见形式<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">function fn()&#123;</span><br><span class="line">  var a = &#123;</span><br><span class="line">    n: 1</span><br><span class="line">  &#125;</span><br><span class="line">  function fn2()&#123;</span><br><span class="line">    a.n += 1</span><br><span class="line">    return a.n</span><br><span class="line">  &#125;</span><br><span class="line">  return fn2</span><br><span class="line">&#125;</span><br><span class="line">var fn1 = fn()</span><br><span class="line">fn1() // 2</span><br><span class="line">// 上面代码其实就是</span><br><span class="line">(function()&#123;</span><br><span class="line">  var a = &#123;</span><br><span class="line">    n: 1</span><br><span class="line">  &#125;</span><br><span class="line">  return function()&#123;</span><br><span class="line">    a.n += 1</span><br><span class="line">    return a.n</span><br><span class="line">  &#125;</span><br><span class="line">&#125;.call()) // IIFE</span><br><span class="line">.call()// 2</span><br></pre></td></tr></table></figure></p>
<p><strong>现在我们明白了为什么闭包一般在 IIFE 里出现</strong><br> IIFE 提供局部变量的环境，才有闭包的用武之地<br><strong>return 的作用</strong><br>上面代码中的 return 和 window 的作用一样，是为了让外部能够访问函数作用域内部的函数，当然 return a.n 的作用也是如此</p>
<p><strong>而闭包的作用，至此应该理解了</strong></p>
<hr>
<p>本文仅作为个人学习使用</p>
<p>相关参考：<br><a href="http://benalman.com/news/2010/11/immediately-invoked-function-expression/#iife" target="_blank" rel="noopener">Immediately-Invoked Function Expression (IIFE)</a><br><a href="https://zhuanlan.zhihu.com/p/22465092" target="_blank" rel="noopener">「每日一题」什么是立即执行函数？有什么作用？</a><br><a href="https://zhuanlan.zhihu.com/p/22486908" target="_blank" rel="noopener">「每日一题」JS 中的闭包是什么？</a><br><a href="https://wangdoc.com/javascript/types/function.html#%E7%AB%8B%E5%8D%B3%E8%B0%83%E7%94%A8%E7%9A%84%E5%87%BD%E6%95%B0%E8%A1%A8%E8%BE%BE%E5%BC%8F%EF%BC%88iife%EF%BC%89" target="_blank" rel="noopener">JS标准参考教程——IIFE</a><br><a href="http://es6.ruanyifeng.com/#docs/let#%E5%9D%97%E7%BA%A7%E4%BD%9C%E7%94%A8%E5%9F%9F" target="_blank" rel="noopener">ES6入门——let#块级作用域</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://adashuai5.com/2018/08/18/MVC-初尝试之-V-和-C/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Zhou Yuanda">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Ada 的个人博客主页">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/08/18/MVC-初尝试之-V-和-C/" itemprop="url">MVC 初尝试之 V 和 C</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-08-18T16:51:10+08:00">
                2018-08-18
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2018/08/18/MVC-初尝试之-V-和-C/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="/2018/08/18/MVC-初尝试之-V-和-C/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  1.5k
                </span>
              

              

              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="什么是MVC"><a href="#什么是MVC" class="headerlink" title="什么是MVC"></a>什么是<a href="http://www.ruanyifeng.com/blog/2007/11/mvc.html" target="_blank" rel="noopener">MVC</a><img src="https://upload-images.jianshu.io/upload_images/7094266-bd2a358032410034.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></h1><p>视图（View）：用户界面。<br>控制器（Controller）：业务逻辑<br>模型（Model）：数据保存<br><img src="https://upload-images.jianshu.io/upload_images/7094266-6f849f9b1d7762be.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""><br>View 传送指令到 Controller<br>Controller 完成业务逻辑后，要求 Model 改变状态<br>Model 将新的数据发送到 View，用户得到反馈</p>
<h1 id="那么怎么做呢"><a href="#那么怎么做呢" class="headerlink" title="那么怎么做呢"></a>那么怎么做呢</h1><p><strong>1.模块化你的js代码</strong><br>将同一模块的js代码放在同一个文件夹里并正确命名，用立即执行函数<a href="https://www.jianshu.com/p/d880bacbc0e9" target="_blank" rel="noopener">相关博客</a>封装代码，防止出现全局变量<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 模块化 --&gt;</span><br><span class="line">    &lt;script src=&quot;./js/init-swiper.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">    &lt;script src=&quot;./js/auto-slide-up.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">    &lt;script src=&quot;./js/sticky-topbar.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">    &lt;script src=&quot;./js/smoothly-navigation.js&quot;&gt;&lt;/script&gt;</span><br></pre></td></tr></table></figure></p>
<p><strong>2.设置 V 和 C</strong></p>
<p>2.1.首先简单区分出 V 和 C<br>找到 js 模块对应的 html 模块，即是 view<br>view 的作用是告诉js哪一部分是对应模块的 view<br>以轮播模块为例<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 这就是 view ，用户可以看到 --&gt;</span><br><span class="line">&lt;div id=&quot;mySlides&quot;&gt;</span><br><span class="line">    &lt;!-- Slider main container --&gt;</span><br><span class="line">    &lt;div class=&quot;swiper-container&quot;&gt;</span><br><span class="line">        &lt;!-- Additional required wrapper --&gt;</span><br><span class="line">        &lt;div class=&quot;swiper-wrapper&quot;&gt;</span><br><span class="line">            &lt;!-- Slides --&gt;</span><br><span class="line">            &lt;img src=&quot;./img/works/nav-page.jpg&quot; class=&quot;swiper-slide&quot;&gt;</span><br><span class="line">            &lt;img src=&quot;./img/works/canvas.jpg&quot; class=&quot;swiper-slide&quot;&gt;</span><br><span class="line">            &lt;img src=&quot;./img/works/apple-style-slides.jpg&quot; class=&quot;swiper-slide&quot;&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">        &lt;!-- If we need pagination --&gt;</span><br><span class="line">        &lt;div class=&quot;swiper-pagination&quot;&gt;&lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    &lt;!-- If we need navigation buttons --&gt;</span><br><span class="line">    &lt;div class=&quot;swiper-button-prev&quot;&gt;&lt;/div&gt;</span><br><span class="line">    &lt;div class=&quot;swiper-button-next&quot;&gt;&lt;/div&gt;</span><br><span class="line">&lt;/div&gt;</span><br></pre></td></tr></table></figure></p>
<p>2.1.1.在 js 中声明一个 view 作为 js 模块的 view，如轮播模块的 view 为 #mySlides<br>2.1.2.声明一个 controller 他是 view 的函数<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">!function()&#123;</span><br><span class="line">    var view = document.querySelector(&apos;#mySlides&apos;)</span><br><span class="line">    var controller = function(view)&#123;</span><br><span class="line">        var mySwiper = new Swiper(view.querySelector(&apos;.swiper-container&apos;), &#123;</span><br><span class="line">            loop: true,</span><br><span class="line">            // If we need pagination</span><br><span class="line">            pagination: &#123;</span><br><span class="line">                el: &apos;.swiper-pagination&apos;,</span><br><span class="line">            &#125;,</span><br><span class="line">        </span><br><span class="line">            // Navigation arrows</span><br><span class="line">            navigation: &#123;</span><br><span class="line">                nextEl: &apos;.swiper-button-next&apos;,</span><br><span class="line">                prevEl: &apos;.swiper-button-prev&apos;,</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    controller(view)</span><br><span class="line">&#125;.call()</span><br></pre></td></tr></table></figure></p>
<p>2.2.再简化一下<br>用另一个模块 topNavBar 举例（可以看到每个模块结构是一致的）<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">! function () &#123;</span><br><span class="line">    var view = document.querySelector(&apos;#topNavBar&apos;)</span><br><span class="line">    //把 controller 变成对象</span><br><span class="line">    var controller = &#123;</span><br><span class="line">        //把函数放到 init 里（init 即是初始化）</span><br><span class="line">        init: function (view) &#123;</span><br><span class="line">            window.addEventListener(&apos;scroll&apos;, function (x) &#123;</span><br><span class="line">                if (window.scrollY &gt; 0) &#123;</span><br><span class="line">                    topNavBar.classList.add(&apos;sticky&apos;)</span><br><span class="line">                &#125; else &#123;</span><br><span class="line">                    topNavBar.classList.remove(&apos;sticky&apos;)</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    //此时 controller(view) 就变成了 controller.init(view)</span><br><span class="line">    controller.init(view)</span><br><span class="line">&#125;.call()</span><br></pre></td></tr></table></figure></p>
<p>下面是关键<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">! function () &#123;</span><br><span class="line">    var view = document.querySelector(&apos;#topNavBar&apos;)</span><br><span class="line">    var controller = &#123;</span><br><span class="line">        //开始 controller 有个空的 view     </span><br><span class="line">        view: null,</span><br><span class="line">        //有个初始化函数</span><br><span class="line">        init: function (view) &#123;</span><br><span class="line">            //把 view 存到 controller 的 view 里</span><br><span class="line">            this.view = view</span><br><span class="line">            //下面代码 this.bindEvents.call(this)</span><br><span class="line">            this.bindEvents()</span><br><span class="line">        &#125;,</span><br><span class="line">        //绑定事件</span><br><span class="line">        bindEvents: function () &#123;</span><br><span class="line">            //所以这里的 this 就是上面的 this</span><br><span class="line">            //上面的 this 就等于 controller.init(view)</span><br><span class="line">            //controller.init(view) 的 this 就是 controller</span><br><span class="line">            var view = this.view</span><br><span class="line">            window.addEventListener(&apos;scroll&apos;, function (x) &#123;</span><br><span class="line">                if (window.scrollY &gt; 0) &#123;</span><br><span class="line">                    topNavBar.classList.add(&apos;sticky&apos;)</span><br><span class="line">                &#125; else &#123;</span><br><span class="line">                    topNavBar.classList.remove(&apos;sticky&apos;)</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    //下面代码等价于controller.init.call(controller,view) 即 this 就是controller</span><br><span class="line">    controller.init(view)</span><br><span class="line">&#125;.call()</span><br></pre></td></tr></table></figure></p>
<p>controller 有个 view，有个初始化函数，并可以绑定事件<br>下面优化绑定事件函数内部代码，让其只起绑定事件的作用<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">window.addEventListener(&apos;scroll&apos;, function (x) &#123;</span><br><span class="line">    if (window.scrollY &gt; 0) &#123;</span><br><span class="line">        topNavBar.classList.add(&apos;sticky&apos;)</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        topNavBar.classList.remove(&apos;sticky&apos;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></p>
<p>由于 addEventListener 里面的 this 代表用户触发的元素<br>但是我们希望 this 与原来一致<br><strong>解决方法一：用 bind()</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">window.addEventListener(&apos;scroll&apos;, function (x) &#123;</span><br><span class="line">    if (window.scrollY &gt; 0) &#123;</span><br><span class="line">        topNavBar.classList.add(&apos;sticky&apos;)</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        topNavBar.classList.remove(&apos;sticky&apos;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;).bind(this)</span><br></pre></td></tr></table></figure></p>
<p><strong>解决方法二：</strong><br>用箭头函数，由于箭头函数没有 this ，所以当我们在其内部使用 this 默认就是外部的 this。<br><strong>可以说箭头函数内外 this 不变，我们的目的就是让函数内外 this 不变</strong></p>
<p>然后将 addClass 和 remove Class 事件也用各自的函数分隔开，同样用 this 和 view 串起来<br>完整代码<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">! function () &#123;</span><br><span class="line">    var view = document.querySelector(&apos;#topNavBar&apos;)</span><br><span class="line">    var controller = &#123;</span><br><span class="line">        view: null,</span><br><span class="line">        init: function (view) &#123;</span><br><span class="line">            this.view = view</span><br><span class="line">            this.bindEvents()</span><br><span class="line">        &#125;,</span><br><span class="line">        bindEvents: function () &#123;</span><br><span class="line">            var view = this.view</span><br><span class="line">            window.addEventListener(&apos;scroll&apos;, (x) =&gt;&#123;</span><br><span class="line">                if (window.scrollY &gt; 0) &#123;</span><br><span class="line">                    this.active()</span><br><span class="line">                &#125; else &#123;</span><br><span class="line">                    this.deactive()</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;,</span><br><span class="line">        active:function()&#123;</span><br><span class="line">            this.view.classList.add(&apos;sticky&apos;)</span><br><span class="line">        &#125;,</span><br><span class="line">        deactive:function()&#123;</span><br><span class="line">            this.view.classList.remove(&apos;sticky&apos;)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    controller.init(view)</span><br><span class="line">&#125;.call()</span><br></pre></td></tr></table></figure></p>
<p>轮播完整代码<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">! function () &#123;</span><br><span class="line">    var view = document.querySelector(&apos;#mySlides&apos;)</span><br><span class="line">    var controller = &#123;</span><br><span class="line">        view: null,</span><br><span class="line">        swiper: null,</span><br><span class="line">        swiperOptions: &#123;</span><br><span class="line">            loop: true,</span><br><span class="line">            pagination: &#123;</span><br><span class="line">                el: &apos;.swiper-pagination&apos;,</span><br><span class="line">            &#125;,</span><br><span class="line">            navigation: &#123;</span><br><span class="line">                nextEl: &apos;.swiper-button-next&apos;,</span><br><span class="line">                prevEl: &apos;.swiper-button-prev&apos;,</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        init: function (view) &#123;</span><br><span class="line">            this.view = view</span><br><span class="line">            this.initSwiper()</span><br><span class="line">        &#125;,</span><br><span class="line">        initSwiper: function () &#123;</span><br><span class="line">            this.swiper = new Swiper(</span><br><span class="line">                this.view.querySelector(&apos;.swiper-container&apos;), </span><br><span class="line">                this.swiperOptions</span><br><span class="line">            )</span><br><span class="line">        &#125;,</span><br><span class="line">    &#125;</span><br><span class="line">    controller.init(view)</span><br><span class="line">&#125;.call()</span><br></pre></td></tr></table></figure></p>
<p>smoothly-navigation.js 模块代码<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">! function () &#123;</span><br><span class="line">    var view = document.querySelector(&apos;nav.menu&apos;)</span><br><span class="line">    var controller = &#123;</span><br><span class="line">        view: null,</span><br><span class="line">        aTags: null,</span><br><span class="line">        init: function (view) &#123;</span><br><span class="line">            this.view = view</span><br><span class="line">            this.initAnimation()</span><br><span class="line">            this.bindEvents()</span><br><span class="line">        &#125;,</span><br><span class="line">        initAnimation: function () &#123;</span><br><span class="line">            function animate(time) &#123;</span><br><span class="line">                requestAnimationFrame(animate);</span><br><span class="line">                TWEEN.update(time);</span><br><span class="line">            &#125;</span><br><span class="line">            requestAnimationFrame(animate);</span><br><span class="line">        &#125;,</span><br><span class="line">        scrollToElement: function (element) &#123;</span><br><span class="line">            let top = element.offsetTop</span><br><span class="line">            let currentTop = window.scrollY</span><br><span class="line">            let targetTop = top - 80</span><br><span class="line">            let s = targetTop - currentTop //路程</span><br><span class="line">            var coords = &#123;</span><br><span class="line">                y: currentTop</span><br><span class="line">            &#125;; //起始位置</span><br><span class="line">            var t = Math.abs(s / 100) * 300;</span><br><span class="line">            if (t &gt; 500) &#123;</span><br><span class="line">                t = 500</span><br><span class="line">            &#125; //时间</span><br><span class="line">            var tween = new TWEEN.Tween(coords) //起始位置</span><br><span class="line">                .to(&#123;</span><br><span class="line">                    y: targetTop</span><br><span class="line">                &#125;, t) //结束位置和时间</span><br><span class="line">                .easing(TWEEN.Easing.Quadratic.InOut) //缓动类型</span><br><span class="line">                .onUpdate(function () &#123;</span><br><span class="line">                    //coords.y 已经变了</span><br><span class="line">                    window.scrollTo(0, coords.y) //如何更新界面</span><br><span class="line">                &#125;)</span><br><span class="line">                .start(); //开始缓动</span><br><span class="line">        &#125;,</span><br><span class="line">        bindEvents: function () &#123;</span><br><span class="line">            let aTags = this.view.querySelectorAll(&apos;nav.menu &gt; ul &gt; li &gt; a&apos;)</span><br><span class="line">            for (let i = 0; i &lt; aTags.length; i++) &#123;</span><br><span class="line">                aTags[i].onclick = (x) =&gt;&#123;</span><br><span class="line">                    x.preventDefault()</span><br><span class="line">                    let a = x.currentTarget</span><br><span class="line">                    let href = a.getAttribute(&apos;href&apos;) //&apos;#siteAbout&apos;</span><br><span class="line">                    let element = document.querySelector(href)</span><br><span class="line">                    this.scrollToElement(element)</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    controller.init(view)</span><br><span class="line">&#125;.call()</span><br></pre></td></tr></table></figure></p>
<h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>所有模块结构：<br><strong>在立即执行函数内部</strong><br><strong>有个 view</strong><br><strong>有个 controller</strong><br><strong>controller 操作 view</strong><br>将复杂的代码模块化，然后通过对象 controller 将 view 的函数通过 this 串起来，使得每一个 view 的函数都可以被 controller 操控</p>
<p><strong>后续：MVC 的 M：<a href="https://www.jianshu.com/p/039f910539d8" target="_blank" rel="noopener">做一个简单的留言——leancloud数据库</a></strong></p>
<hr>
<p>本文仅供个人学习使用</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://adashuai5.com/2018/08/12/实现一个AJAX/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Zhou Yuanda">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Ada 的个人博客主页">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/08/12/实现一个AJAX/" itemprop="url">实现一个AJAX</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-08-12T12:28:53+08:00">
                2018-08-12
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2018/08/12/实现一个AJAX/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="/2018/08/12/实现一个AJAX/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  1.4k
                </span>
              

              

              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><a href="https://www.jianshu.com/p/4591a66c50f5" target="_blank" rel="noopener">AJAX是什么鬼</a> 续篇</p>
<h1 id="今天我们给AJAX封装一下"><a href="#今天我们给AJAX封装一下" class="headerlink" title="今天我们给AJAX封装一下"></a>今天我们给AJAX封装一下</h1><p>之前写了篇有关用原生JS写jQuery的<a href="https://www.jianshu.com/p/7e663286cb35" target="_blank" rel="noopener">博客</a><br>下面是相关主要代码<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">window.jQuery = function (nodeOrSelector) &#123;</span><br><span class="line">    let nodes = &#123;&#125;</span><br><span class="line">    nodes.addClass = function () &#123;&#125;</span><br><span class="line">    nodes.html = function () &#123;&#125;</span><br><span class="line">    return nodes</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>事实上就是用函数给代码封装一下并设定相关参数<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">window.jQuery.ajax = function (url, method, body, succseeFn, failFn) &#123;</span><br><span class="line">    let request = new XMLHttpRequest()</span><br><span class="line">    //初始化请求</span><br><span class="line">    request.open(method, url)</span><br><span class="line">    request.onreadystatechange = () =&gt; &#123;</span><br><span class="line">        if (request.readyState === 4) &#123;</span><br><span class="line">            if (request.status &gt;= 200 &amp;&amp; request.status &lt; 300) &#123;</span><br><span class="line">                succseeFn.call(undefined, request.responseText)</span><br><span class="line">            &#125; else if (request.status &gt;= 400) &#123;</span><br><span class="line">                failFn.call(undefined, request)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    request.send(body)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">window.$ = window.jQuery</span><br></pre></td></tr></table></figure>
<p>可以使用$.ajax了<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">myButton.addEventListener(&apos;click&apos;, (e) =&gt; &#123;</span><br><span class="line">    $.ajax(</span><br><span class="line">        &apos;/ada&apos;,</span><br><span class="line">        &apos;post&apos;,</span><br><span class="line">        &apos;a=1&amp;b=2&apos;,</span><br><span class="line">        (responseText) =&gt; &#123;</span><br><span class="line">            console.log(&apos;s&apos;)</span><br><span class="line">        &#125;,</span><br><span class="line">        (request) =&gt; &#123;</span><br><span class="line">            console.log(&apos;f&apos;)</span><br><span class="line">        &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></p>
<p><strong>但是这个$.ajax依然有问题</strong><br>1.给定的参数顺序太死<br>如果我不传其中一个参数，就需要给这个参数所在位置占位，如若method是’get’，就不返回body，那就需要用undefined等占位<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&apos;/ada&apos;,</span><br><span class="line">&apos;post&apos;,</span><br><span class="line">//null，undefined或&apos;&apos; 占位</span><br><span class="line">&apos;&apos;,</span><br><span class="line">(responseText) =&gt; &#123;</span><br><span class="line">      console.log(&apos;s&apos;)</span><br><span class="line">&#125;,</span><br><span class="line">(request) =&gt; &#123;</span><br><span class="line">      console.log(&apos;f&apos;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></p>
<p>2.无法直观解释参数意思。<br>比如上面代码，如果你没看过前面内容或者原生JS代码，你都不知道这些参数分别表达的是什么意思。</p>
<p><strong>解决方法：给参数命名呗</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">window.jQuery.ajax = function (options) &#123;</span><br><span class="line">    //给参数一个选项</span><br><span class="line">    let method = options.method</span><br><span class="line">    let url = options.url</span><br><span class="line">    let body = options.body</span><br><span class="line">    let succseeFn = options.succseeFn</span><br><span class="line">    let failFn = options.failFn</span><br><span class="line"></span><br><span class="line">    let request = new XMLHttpRequest()</span><br><span class="line">    //初始化请求</span><br><span class="line">    request.open(method, url)</span><br><span class="line">    request.onreadystatechange = () =&gt; &#123;</span><br><span class="line">        if (request.readyState === 4) &#123;</span><br><span class="line">            if (request.status &gt;= 200 &amp;&amp; request.status &lt; 300) &#123;</span><br><span class="line">                succseeFn.call(undefined, request.responseText)</span><br><span class="line">            &#125; else if (request.status &gt;= 400) &#123;</span><br><span class="line">                failFn.call(undefined, request)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    request.send(body)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">myButton.addEventListener(&apos;click&apos;, (e) =&gt; &#123;</span><br><span class="line">    //以对象的形式传参数</span><br><span class="line">    $.ajax(&#123;</span><br><span class="line">        url: &apos;/ada&apos;,</span><br><span class="line">        method: &apos;post&apos;,</span><br><span class="line">        body: &apos;a=1&amp;b=2&apos;,</span><br><span class="line">        succseeFn: (responseText) =&gt; &#123;</span><br><span class="line">            console.log(&apos;s&apos;)</span><br><span class="line">        &#125;,</span><br><span class="line">        failFn: (request) =&gt; &#123;</span><br><span class="line">            console.log(&apos;f&apos;)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></p>
<p><strong>加一个 setRequestHeader：设置请求第二部分</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">headers: &#123;</span><br><span class="line">    &apos;content-type&apos;:&apos;application/x-www-form-urlencoded&apos;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>$.ajax 部分遍历一下 headers<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">let headers = options.headers</span><br><span class="line">//下面代码放在 requset.open() 后</span><br><span class="line">for (let key in headers) &#123;</span><br><span class="line">    let value = headers[key]</span><br><span class="line">    request.setRequestHeader(key, value)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p><img src="https://upload-images.jianshu.io/upload_images/7094266-5f2a6c8a84d872fb.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""><br><strong>如何向 $.ajax 传两个参数：如 jQuery.ajax( url [, options ] )</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">let url</span><br><span class="line">if(arguments.length === 1)&#123;</span><br><span class="line">    url = options.url</span><br><span class="line">&#125;else if(arguments.length === 2)&#123;</span><br><span class="line">    url = arguments[0]</span><br><span class="line">    options = arguments[1]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>现在我们的$.ajax 已经和jQuery的一样了</p>
<hr>
<p><strong>优化一下代码，先不管两个参数那个</strong></p>
<p><strong>1.ES6的 <a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Operators/Destructuring_assignment" target="_blank" rel="noopener">解构赋值</a></strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">//这6行代码太丑了</span><br><span class="line">let url= options</span><br><span class="line">let method = options.method</span><br><span class="line">let body = options.body</span><br><span class="line">let succseeFn = options.succseeFn</span><br><span class="line">let failFn = options.failFn</span><br><span class="line">let headers = options.headers</span><br><span class="line">//用ES6解构赋值,上面代码等价于</span><br><span class="line">let = &#123;url,method,body,headers,successFn,failFn&#125; = options</span><br></pre></td></tr></table></figure></p>
<p>可以不要 options 了<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">window.jQuery.ajax = function (&#123;url,method,body,headers,succseeFn,failFn&#125;)&#123;&#125;</span><br></pre></td></tr></table></figure></p>
<p><strong>2.Promise，相关知识可以<a href="http://es6.ruanyifeng.com/#docs/promise" target="_blank" rel="noopener">参考</a></strong><br>之前我们给参数命名了，我是知道了这个参数代表什么。<br>但是每个人的命名都会不一样，比如 jQuery 的 ajax 对响应成功的命名就是 success 而我的是 successFn。<br>这对于不熟悉对应文档的人来说，使用十分不便。<br>针对这个问题，就有了 Promise<br>Promise的形式<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">window.Promise = function(fn)&#123;</span><br><span class="line">    //...</span><br><span class="line">    return &#123;</span><br><span class="line">        then:function()&#123;&#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>用Promise函数：resolve,reject 替换 successFn 和 failFn，这个两个参数是ES6规定的，这样就不会有上述问题了<br>return new Promise(function(resolve,reject){})<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">window.jQuery.ajax = function (&#123;url,method,body,headers&#125;) &#123;</span><br><span class="line">    //之前代码返回值是 undefined，我们return一个Promise</span><br><span class="line">    return new Promise(function(resolve,reject)&#123;</span><br><span class="line">        let request = new XMLHttpRequest()</span><br><span class="line">    //初始化请求</span><br><span class="line">    request.open(method, url)</span><br><span class="line">    for (let key in headers) &#123;</span><br><span class="line">        let value = headers[key]</span><br><span class="line">        request.setRequestHeader(key, value)</span><br><span class="line">    &#125;</span><br><span class="line">    request.onreadystatechange = () =&gt; &#123;</span><br><span class="line">        if (request.readyState === 4) &#123;</span><br><span class="line">            if (request.status &gt;= 200 &amp;&amp; request.status &lt; 300) &#123;</span><br><span class="line">                // successFn 就由 resove 代替了</span><br><span class="line">                resolve.call(undefined, request.responseText)</span><br><span class="line">            &#125; else if (request.status &gt;= 400) &#123;</span><br><span class="line">                // failFn 就由 reject 代替了</span><br><span class="line">                reject.call(undefined, request)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    request.send(body)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">window.$ = window.jQuery</span><br><span class="line"></span><br><span class="line">myButton.addEventListener(&apos;click&apos;, (e) =&gt; &#123;</span><br><span class="line">    //以对象的形式传参数</span><br><span class="line">    $.ajax(&#123;</span><br><span class="line">        url: &apos;/ada&apos;,</span><br><span class="line">        method: &apos;post&apos;,</span><br><span class="line">        headers: &#123;</span><br><span class="line">            &apos;content-type&apos;: &apos;application/x-www-form-urlencoded&apos;,</span><br><span class="line">            &apos;ada&apos;: &apos;18&apos;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;).then(</span><br><span class="line">        //成功后执行的代码</span><br><span class="line">        (responseText)=&gt;&#123;console.log(responseText)&#125;,</span><br><span class="line">        //失败后执行的代码</span><br><span class="line">        (request)=&gt;&#123;console.log(request)&#125;</span><br><span class="line">      )</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></p>
<p>then 后再 then<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">.then(</span><br><span class="line">    //成功后执行的代码</span><br><span class="line">    (responseText)=&gt;&#123;console.log(responseText);return &apos;处理成功&apos;&#125;, </span><br><span class="line">    //失败后执行的代码</span><br><span class="line">    (request)=&gt;&#123;console.log(request);return &apos;处理失败&apos;&#125;</span><br><span class="line">    ).then(</span><br><span class="line">    //上一次成功后的return</span><br><span class="line">    (responseText)=&gt;&#123;console.log(responseText)&#125;,</span><br><span class="line">    //上一次失败后的return</span><br><span class="line">    (request)=&gt;&#123;console.log(request)&#125;</span><br><span class="line">)</span><br></pre></td></tr></table></figure></p>
<p>可以看下结果<img src="https://upload-images.jianshu.io/upload_images/7094266-46960dc591ffab15.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>完整代码请看 <a href="https://github.com/Adashuai5/node-demo/tree/master/jQuery.AJAX" target="_blank" rel="noopener">github</a></p>
<hr>
<p>#小记<br><strong>AJAX 的所有功能</strong><br>客户端的JS发起请求（浏览器上的）<br>服务端的JS发送响应（Node.js上的）<br><strong>1.JS 可以设置任意请求 header</strong><br>第一部分 request.open(method, url)<br>第二部分 request.setRequstHeader(‘content-type’,’application/x-www-form-urlencoded’)<br>第四部分 request.send(body)<br><strong>2.JS 可以获取任意响应 header</strong><br>第一部分 request.status / request.statusText<br>第二部分 request.getResponseHeader() / request.getAllResponseHeaders()<br>第四部分 request.responseText<br>图解<img src="https://upload-images.jianshu.io/upload_images/7094266-82d62fca23713ea1.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p><strong>有关回调 (callback:打电话回来)：</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">succseeFn.call(undefined, request.responseText)</span><br><span class="line">//这种形式就是回调</span><br><span class="line">succseeFn: () =&gt; &#123;&#125;</span><br></pre></td></tr></table></figure></p>
<p><strong>promise 的 .then() 和 .then().then() 理解</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">.then(</span><br><span class="line">  fn1,fn2</span><br><span class="line">).then(</span><br><span class="line">  fn3,fn4</span><br><span class="line">  )</span><br></pre></td></tr></table></figure></p>
<p>.then( , ) 逗号左边为成功执行，右边为失败执行<br>我们可以称第一个： <strong>.then( fn1 , fn2 )</strong>为第一负责人；第二个： <strong>.then( fn3 , fn4 )</strong>为第二负责人</p>
<h2 id="第一负责人成功则执行-fn1-，失败则执行-fn2；第一负责人处理完成处理则第二负责人执行-fn3-，处理不好（如代码有问题）则执行-fn4"><a href="#第一负责人成功则执行-fn1-，失败则执行-fn2；第一负责人处理完成处理则第二负责人执行-fn3-，处理不好（如代码有问题）则执行-fn4" class="headerlink" title="第一负责人成功则执行 fn1 ，失败则执行 fn2；第一负责人处理完成处理则第二负责人执行 fn3 ，处理不好（如代码有问题）则执行 fn4"></a>第一负责人成功则执行 fn1 ，失败则执行 fn2；第一负责人处理完成处理则第二负责人执行 fn3 ，处理不好（如代码有问题）则执行 fn4</h2><p>本文仅供个人学习使用</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://adashuai5.com/2018/08/12/理解JSONP-下/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Zhou Yuanda">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Ada 的个人博客主页">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/08/12/理解JSONP-下/" itemprop="url">理解JSONP 下</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-08-12T12:25:05+08:00">
                2018-08-12
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2018/08/12/理解JSONP-下/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="/2018/08/12/理解JSONP-下/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  759
                </span>
              

              

              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><a href="https://www.jianshu.com/p/2a2fe02917e7" target="_blank" rel="noopener">理解JSONP 上</a></p>
<h1 id="跨域SRJ"><a href="#跨域SRJ" class="headerlink" title="跨域SRJ"></a>跨域SRJ</h1><p><strong>如果我访问其他网站的服务器，可以吗？<br>由于JSONP可以规避同源策略，因此可以</strong><br>下面我们自己做两个网站尝试一下<br>请求方：ada.com （浏览器）<br>响应方：jack.com （服务器）</p>
<p>Linux 或 mac直接<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vi /etc/hosts</span><br></pre></td></tr></table></figure></p>
<p>windows需要找到/etc/hosts文件 比较难找，推荐Everything<img src="https://upload-images.jianshu.io/upload_images/7094266-19f9953c967705a5.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="">在hosts文件下编辑两个网站<img src="https://upload-images.jianshu.io/upload_images/7094266-28b643545d3a06f3.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="">打开两个 node 服务器<img src="https://upload-images.jianshu.io/upload_images/7094266-3cd83a6dd9b8e522.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>将script.src改成后端服务器的jack.com<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">script.src = &apos;http://jack.com:8002/pay&apos;</span><br></pre></td></tr></table></figure></p>
<p>成功在 ada.com里接收到jack.com，ada.com 的前端程序员成功向jack.com 的后端程序员发起请求并得到响应<img src="https://upload-images.jianshu.io/upload_images/7094266-455e37f97e889991.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="">跨域SRJ成功</p>
<h1 id="代码分离："><a href="#代码分离：" class="headerlink" title="代码分离："></a>代码分离：</h1><p><strong>耦合</strong>和<strong>解耦</strong><img src="https://upload-images.jianshu.io/upload_images/7094266-39446f3e68a37a78.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="">上面的amount.innerText=amount.innerText-1就是前端页面的代码，这说明jack.com 的后端程序元需要对ada.com的页面细节了解的很清楚，这种情况叫做耦合<br>那我们让前后端分离呗，即解耦<br>后端改成<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">//获取参数.call（this，成功）</span><br><span class="line">response.write(`$&#123;query.callbackName&#125;.call(undefined,&apos;success&apos;)`)</span><br></pre></td></tr></table></figure></p>
<p>前端给参<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">//callbackName = 随便</span><br><span class="line">script.src = &apos;http://jack.com:8002/pay?callbackName=yyy&apos;</span><br></pre></td></tr></table></figure></p>
<h1 id="JSONP"><a href="#JSONP" class="headerlink" title="JSONP:"></a>JSONP:</h1><p><img src="https://upload-images.jianshu.io/upload_images/7094266-9442483142643759.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>上面代码高亮的部分就是<a href="https://www.json.org/" target="_blank" rel="noopener">JSON</a>（一个键必须是双引号的对象）<br>JSON左边的代码就是左padding，右边就是右padding，所以JSONP=JSON +Padding</p>
<h1 id="让我们理一下过程"><a href="#让我们理一下过程" class="headerlink" title="让我们理一下过程"></a>让我们理一下过程</h1><p>请求方：ada.com 的前端程序员（浏览器）<br>响应方：jack.com 的后端程序员（服务器）<br>1.请求方创建 script，src 指向响应方，同时传一个查询参数 ?callbackName=yyy<br>2.响应方根据查询参数callbackName，构造形如<br>yyy.call(undefined, ‘你要的数据’)<br>yyy(‘你要的数据’)<br>这样的响应<br>3.浏览器接收到响应，就会执行 yyy.call(undefined, ‘你要的数据’)<br>4.那么请求方就知道了他要的数据<br>这就是 JSONP<br><strong>约定：</strong><br>callbackName -&gt; callback<br>yyy -&gt; 随机数 如 ada1213123123412()</p>
<h1 id="JSONP方案"><a href="#JSONP方案" class="headerlink" title="JSONP方案"></a>JSONP方案</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">button.addEventListener(&apos;click&apos;, (e)=&gt;&#123;</span><br><span class="line">    let script = document.createElement(&apos;script&apos;)</span><br><span class="line">    let functionName = &apos;ada&apos;+ parseInt(Math.random()*10000000 ,10)</span><br><span class="line">    window[functionName] = function()&#123;  // 每次请求之前搞出一个随机的函数</span><br><span class="line">        amount.innerText = amount.innerText - 1</span><br><span class="line">    &#125;</span><br><span class="line">    script.src = &apos;http://jack.com:8002/pay?callback=&apos; + functionName</span><br><span class="line">    document.body.appendChild(script)</span><br><span class="line">    script.onload = function(e)&#123; // 状态码是 200~299 则表示成功</span><br><span class="line">        e.currentTarget.remove()</span><br><span class="line">        delete window[functionName] // 请求完了就干掉这个随机函数</span><br><span class="line">    &#125;</span><br><span class="line">    script.onload = function(e)&#123; // 状态码大于等于 400 则表示失败</span><br><span class="line">        e.currentTarget.remove()</span><br><span class="line">        delete window[functionName] // 请求完了就干掉这个随机函数</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>Node部分：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">if (path === &apos;/pay&apos;) &#123;</span><br><span class="line">    var amount = fs.readFileSync(&apos;./db&apos;, &apos;utf8&apos;)</span><br><span class="line">    var newAmount = amount - 1</span><br><span class="line">    fs.writeFileSync(&apos;./db&apos;, newAmount)</span><br><span class="line">    response.setHeader(&apos;Content-Type&apos;, &apos;application/javascript&apos;)</span><br><span class="line">    response.write(`$&#123;query.callbackName&#125;.call(undefined,</span><br><span class="line">      &apos;success&apos;`)</span><br><span class="line">    response.end()</span><br></pre></td></tr></table></figure></p>
<p>jQuery写法<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">$.ajax(&#123;</span><br><span class="line">url: &quot;http://jack.com:8002/pay&quot;,</span><br><span class="line">dataType: &quot;jsonp&quot;,</span><br><span class="line">success: function( response ) &#123;</span><br><span class="line">    if(response === &apos;success&apos;)&#123;</span><br><span class="line">    amount.innerText = amount.innerText - 1</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></p>
<h1 id="JSONP-为什么不支持-POST？"><a href="#JSONP-为什么不支持-POST？" class="headerlink" title="JSONP 为什么不支持 POST？"></a><a href="https://www.zhihu.com/question/28890257" target="_blank" rel="noopener">JSONP 为什么不支持 POST？</a></h1><p>因为  JSONP 是通过<strong>动态创建 Script</strong> 实现的，而<strong>动态创建 Script</strong>只能用GET请求，不能用POST请求</p>
<hr>
<p>本文主要用于个人学习使用</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://adashuai5.com/2018/08/11/Web-服务器/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Zhou Yuanda">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Ada 的个人博客主页">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/08/11/Web-服务器/" itemprop="url">Web 服务器</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-08-11T17:21:53+08:00">
                2018-08-11
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2018/08/11/Web-服务器/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="/2018/08/11/Web-服务器/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  903
                </span>
              

              

              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><a href="https://segmentfault.com/a/1190000006879700" target="_blank" rel="noopener">从输入URL到页面加载发生了什么</a></p>
<h2 id="什么是Web服务器"><a href="#什么是Web服务器" class="headerlink" title="什么是Web服务器"></a>什么是Web服务器</h2><p>Web 服务器就是一个软件，这个软件监听某个端口。当一个 HTTP 请求到达这个端口后这个软件会接收到，根据请求的 url 和参数发送响应数据，这些数据可以是：1. 本机文件； 2. 通过可执行程序从数据库获取数据后组装的页面</p>
<p><strong>让我们用 node 搭建一个简单的服务器</strong></p>
<p><a href="https://nodejs.org/dist/latest-v10.x/docs/api/http.html#http_request_end_data_encoding_callback" target="_blank" rel="noopener">代码相关HTTP文档</a> 遇到相应API再看，不用一个个看，看不完的<br>新建一个名为 server1.js的代码<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">//通过 require(&apos;http&apos;) 来让服务器支持HTTP协议</span><br><span class="line">var http = require(&apos;http&apos;)</span><br><span class="line">//创建服务器请求和响应的函数</span><br><span class="line">var server = http.createServer(function(request, response)&#123;</span><br><span class="line">  //设置一个2秒的计时器</span><br><span class="line">  setTimeout(function()&#123;</span><br><span class="line">    //.setHeader设置文件类型编码等</span><br><span class="line">    response.setHeader(&apos;Content-Type&apos;,&apos;text/html; charset=utf-8&apos;)</span><br><span class="line">    //.writeHead返回状态码</span><br><span class="line">    response.writeHead(404, &apos;Not Found&apos;)</span><br><span class="line">    response.write(&apos;&lt;html&gt;&lt;head&gt;&lt;meta charset=&quot;gbk&quot; /&gt;&lt;/head&gt;&apos;)</span><br><span class="line">    response.write(&apos;&lt;body&gt;&apos;)</span><br><span class="line">    response.write(&apos;&lt;h1&gt;你好&lt;/h1&gt;&apos;)</span><br><span class="line">    response.write(&apos;&lt;/body&gt;&apos;)</span><br><span class="line">    response.write(&apos;&lt;/html&gt;&apos;)</span><br><span class="line">    //事件&apos;关闭&apos;</span><br><span class="line">    response.end()</span><br><span class="line">  &#125;,2000);</span><br><span class="line">&#125;)</span><br><span class="line">console.log(&apos;open http://localhost:8080&apos;)</span><br><span class="line">//listen(端口)产生HTTP服务器监听链接</span><br><span class="line">server.listen(8080)</span><br></pre></td></tr></table></figure></p>
<p>用命令行打开server1.js所在目录，node 开启服务器<img src="https://upload-images.jianshu.io/upload_images/7094266-59e81063d440a373.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""><br>用浏览器打开<a href="http://localhost:8080，2秒后就返回页面拉![](https://upload-images.jianshu.io/upload_images/7094266-7bf0b304614ce83f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)" target="_blank" rel="noopener">http://localhost:8080，2秒后就返回页面拉![](https://upload-images.jianshu.io/upload_images/7094266-7bf0b304614ce83f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)</a><br>至此，你已经用node.js完成了一个简单的服务器搭建，并用浏览器以<a href="http://localhost:8080向你的服务器发起请求并成功得到响应了" target="_blank" rel="noopener">http://localhost:8080向你的服务器发起请求并成功得到响应了</a></p>
<h3 id="静态服务器"><a href="#静态服务器" class="headerlink" title="静态服务器"></a>静态服务器</h3><p>页面不会变化，展示静态页面<img src="http://upload-images.jianshu.io/upload_images/7094266-19e00ec3472ba838.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image"><br><strong>同样用node尝试一个简单的静态服务器</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">var http = require(&apos;http&apos;)</span><br><span class="line">//用来读取内容</span><br><span class="line">var fs = require(&apos;fs&apos;)</span><br><span class="line"></span><br><span class="line">var server = http.createServer(function(req, res)&#123;</span><br><span class="line">  try&#123;</span><br><span class="line">    //.readFileSync 用于同步读取文件:当前目录下的 hi 文件 下的 目标</span><br><span class="line">    var fileContent = fs.readFileSync(__dirname + &apos;/hi&apos; + req.url)</span><br><span class="line">    res.write(fileContent)</span><br><span class="line">  &#125;catch(e)&#123;</span><br><span class="line">    res.writeHead(404, &apos;not found&apos;)</span><br><span class="line">  &#125;</span><br><span class="line">  res.end()</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">server.listen(8080)</span><br><span class="line">console.log(&apos;visit http://localhost:8080&apos; )</span><br></pre></td></tr></table></figure></p>
<p>我在 hi 文件下新建了一个html文件<img src="https://upload-images.jianshu.io/upload_images/7094266-f1c53aa1769fd9ad.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>命令行<img src="https://upload-images.jianshu.io/upload_images/7094266-9dcba127af327a67.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>这次输入的就是<a href="http://localhost:8080/index.html![](https://upload-images.jianshu.io/upload_images/7094266-986cc0ea222a9586.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)成功拉" target="_blank" rel="noopener">http://localhost:8080/index.html![](https://upload-images.jianshu.io/upload_images/7094266-986cc0ea222a9586.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)成功拉</a></p>
<h3 id="动态服务器"><a href="#动态服务器" class="headerlink" title="动态服务器"></a>动态服务器</h3><p>有个动态软件，可执行动态页面<img src="http://upload-images.jianshu.io/upload_images/7094266-47d1ffd2b592f7e1.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image"><br>这一部分涉及的知识就多了，无法用简单的小示例完整展现，后续应该会有相关博客</p>
<h3 id="以上例子均为-url-同源"><a href="#以上例子均为-url-同源" class="headerlink" title="以上例子均为 url 同源"></a>以上例子均为 url 同源</h3><p>当浏览器向服务器发送请求时，会遇到<strong>不同源</strong>的情况：（有关浏览器同源的详细概念可以参考<a href="http://www.ruanyifeng.com/blog/2016/04/same-origin-policy.html" target="_blank" rel="noopener">阮一峰博客</a>）<br>不同源两种情况下的规避方法：<br>1.服务器同意请求：<br>JSONP：需要后端支持（附上我学习JSONP的相关<a href="https://www.jianshu.com/p/2a2fe02917e7" target="_blank" rel="noopener">博客</a>）<br>CORS(Cross-Origin Resource Sharing)：跨域资源共享（AJAX相关<a href="https://www.jianshu.com/p/4591a66c50f5" target="_blank" rel="noopener">博客</a>）<br>2.服务器不同意请求：<br>利用服务器中转：自己搭建一个服务器，由于服务器访问服务器没有同源要求，可直接访问，自己服务器作为中转，把自己服务器变为情况1，即可通过访问自己服务器再访问到其他服务器相关内容<br>这方面的知识同样可以参考</p>
<h2 id="饥人谷博客-跨域"><a href="#饥人谷博客-跨域" class="headerlink" title="饥人谷博客-跨域"></a><a href="http://book.jirengu.com/fe/%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80/Javascript/%E8%B7%A8%E5%9F%9F.html" target="_blank" rel="noopener">饥人谷博客-跨域</a></h2><p>本文仅供个人学习使用</p>
<p>相关参考及资源链接已在文中标注</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://adashuai5.com/2018/08/11/理解JSONP-上/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Zhou Yuanda">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Ada 的个人博客主页">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/08/11/理解JSONP-上/" itemprop="url">理解JSONP 上</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-08-11T00:06:05+08:00">
                2018-08-11
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2018/08/11/理解JSONP-上/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="/2018/08/11/理解JSONP-上/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  1.6k
                </span>
              

              

              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="我们用node来做一个简易服务器理解JSONP，从而了解在没有Ajax的时代的前端是如何绞尽脑汁做好页面交互的"><a href="#我们用node来做一个简易服务器理解JSONP，从而了解在没有Ajax的时代的前端是如何绞尽脑汁做好页面交互的" class="headerlink" title="我们用node来做一个简易服务器理解JSONP，从而了解在没有Ajax的时代的前端是如何绞尽脑汁做好页面交互的"></a>我们用node来做一个简易服务器理解JSONP，从而了解在没有Ajax的时代的前端是如何绞尽脑汁做好页面交互的</h1><p>有关node搭建服务器的学习可以参考我的<a href="https://www.jianshu.com/p/ba728fb4edb4" target="_blank" rel="noopener">另一篇博客</a><br><strong>node 服务器及页面完整代码 <a href="https://github.com/Adashuai5/node-demo/tree/master/JSONP-demo" target="_blank" rel="noopener">参考</a></strong></p>
<p><strong>首先做一个简单的付款界面</strong><br>点击按钮数字减1（点击按钮金额每次减少1）<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;h5&gt;您的余额是</span><br><span class="line">    &lt;span id=&quot;amount&quot;&gt;100&lt;/span&gt;</span><br><span class="line">&lt;/h5&gt;</span><br><span class="line">&lt;button id=&quot;button&quot;&gt;付款一块钱&lt;/button&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">    button.addEventListener(&apos;click&apos;, (e) =&gt; &#123;</span><br><span class="line">        let n = amount.innerText</span><br><span class="line">        let number = parseInt(n, 10)</span><br><span class="line">        let newNumber = number - 1</span><br><span class="line">        amount.innerText = newNumber</span><br><span class="line">    &#125;)</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure></p>
<p>Node代码：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">if(path == &apos;/&apos;)&#123;</span><br><span class="line">    var string = fs.readFileSync(&apos;./index.html&apos;,&apos;utf8&apos;)</span><br><span class="line">    response.setHeader(&apos;Content-Type&apos;, &apos;text/html; charset=utf-8&apos;)</span><br><span class="line">    response.write(string)</span><br><span class="line">    response.end()</span><br><span class="line">  &#125;else&#123;</span><br><span class="line">    response.statusCode = 404</span><br><span class="line">    response.end()</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure></p>
<p><img src="https://upload-images.jianshu.io/upload_images/7094266-a1ec91f18d1456c2.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>这种方法没有后台数据，刷新页面就恢复100<br><strong>*数据库</strong>是什么鬼<br><strong>只要能长久地存数据，就是数据库</strong><br>1.文件系统是一种数据库<br>2.MySQL 是一种数据库*</p>
<p><strong>那我们给它一个数据库来存储金额呗（命令行操作）</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">//创建一个名为db的文件作为数据库</span><br><span class="line">touch db</span><br><span class="line">//用 vim 打开 db</span><br><span class="line">vi db</span><br><span class="line">//只写入100</span><br><span class="line">i 100 :wq</span><br></pre></td></tr></table></figure></p>
<p>用&amp;&amp;&amp;amount&amp;&amp;&amp;替代html里的100（这什么意思？没什么意思，不容易重复啊）这时前端就可以不管后端数据库里的具体内容了<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;h5&gt;您的余额是</span><br><span class="line">    &lt;span id=&quot;amount&quot;&gt;&amp;&amp;&amp;amount&amp;&amp;&amp;&lt;/span&gt;</span><br><span class="line">&lt;/h5&gt;</span><br><span class="line">&lt;button id=&quot;button&quot;&gt;付款一块钱&lt;/button&gt;</span><br><span class="line">&lt;form action=&quot;/pay&quot; method=&quot;POST&quot;&gt;</span><br><span class="line">    &lt;input type=&quot;text&quot; name=&quot;number&quot; value=&quot;1&quot;&gt;</span><br><span class="line">    &lt;input type=&quot;submit&quot; value=&quot;付款&quot;&gt;</span><br><span class="line">&lt;/form&gt;</span><br></pre></td></tr></table></figure></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">var string = fs.readFileSync(&apos;./index.html&apos;,&apos;utf8&apos;)</span><br><span class="line">//引入db，赋值给变量amout，文件都是字符串类型，所以amount得到的是一个字符串</span><br><span class="line">    var amount = fs.readFileSync(&apos;./db&apos;,&apos;utf8&apos;)</span><br><span class="line">//将html里的那个占位符，替换为db里的内容</span><br><span class="line">    string = string.replace(&apos;&amp;&amp;&amp;amount&amp;&amp;&amp;&apos;,amount)</span><br><span class="line">    response.setHeader(&apos;Content-Type&apos;, &apos;text/html; charset=utf-8&apos;)</span><br><span class="line">    response.write(string)</span><br><span class="line">    response.end()</span><br></pre></td></tr></table></figure>
<p>Node代码<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">//判断路径和post请求</span><br><span class="line">if (path === &apos;/pay&apos; &amp;&amp; method.toUpperCase() === &apos;POST&apos;) &#123;</span><br><span class="line">  //引入db这个文件</span><br><span class="line">  var amount = fs.readFileSync(&apos;./db&apos;, &apos;utf8&apos;)</span><br><span class="line">  //每提交一次db里面的数字就减去1</span><br><span class="line">  var newAmount = amount - 1</span><br><span class="line">  //模拟失败，如果产生的随机数大于0.5就成功</span><br><span class="line">  if (Math.random() &gt; 0.5) &#123;</span><br><span class="line">    //成功后将db文件里写入新的数值</span><br><span class="line">    fs.writeFileSync(&apos;./db&apos;, newAmount)</span><br><span class="line">    response.write(&apos;success&apos;)</span><br><span class="line">  &#125; else &#123;</span><br><span class="line">    response.write(&apos;fail&apos;)</span><br><span class="line">  &#125;</span><br><span class="line">  response.end()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>这种方法，由于有了后台数据库（db文件）就能每次得到的新的数值都会存在里面，即使页面刷新也不会变，缺点：需要返回上一个页面才能看到现在的数值<br>原因是：form表单提交后一定会刷新当前页面，并且会打开一个新的页面</p>
<h3 id="想要不刷新当前页面的方法："><a href="#想要不刷新当前页面的方法：" class="headerlink" title="想要不刷新当前页面的方法："></a>想要不刷新当前页面的方法：</h3><p><strong>经典：用iframe</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;form action=&quot;/pay&quot; method=&quot;POST&quot; target=&quot;result&quot;&gt;</span><br><span class="line">    &lt;input type=&quot;submit&quot; value=&quot;付款&quot;&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line">&lt;iframe name=&quot;result&quot; src=&quot;about:blank&quot; frameborder=&quot;0&quot; height=&quot;200&quot;&gt;&lt;/iframe&gt;</span><br></pre></td></tr></table></figure></p>
<p>这样做的好处是用户可以直接通过 iframe 看到是否付款成功，提升用户体验<br><img src="https://upload-images.jianshu.io/upload_images/7094266-4bc794416aa7fcaf.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p><strong>能不能不用iframe？</strong><br>1.用图片造 get 请求<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;h5&gt;您的余额是&lt;span id=&quot;amount&quot;&gt;&amp;&amp;&amp;amount&amp;&amp;&amp;&lt;/span&gt;&lt;/h5&gt;</span><br><span class="line">&lt;button id=&quot;button&quot;&gt;打钱&lt;/button&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">button.addEventListener(&apos;click&apos;,(e)=&gt;&#123;</span><br><span class="line">  let image = document.createElement(&apos;img&apos;)</span><br><span class="line">  //指定路径</span><br><span class="line">  image.src = &apos;/pay&apos;</span><br><span class="line">  //image加载成功后执行</span><br><span class="line">  image.onload= function()&#123;</span><br><span class="line">    alert(&apos;打钱成功&apos;)</span><br><span class="line">    //Window.location.reload() 是刷新页面，更好的方法是直接减一</span><br><span class="line">    amount.innerText = amount.innerText-1;</span><br><span class="line">  &#125;</span><br><span class="line">  //image加载失败后执行</span><br><span class="line">  image.onerror = function()&#123;</span><br><span class="line">    alert(&apos;打钱失败&apos;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure></p>
<p>Node代码:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">//因为imgae只能是get请求，所以只需判断路径</span><br><span class="line">if(path===&apos;/pay&apos;)&#123;</span><br><span class="line">  var amount = fs.readFileSync(&apos;./db&apos;,&apos;utf8&apos;)</span><br><span class="line">  var newAmount = amount-1</span><br><span class="line">  if(Math.random()&gt;0.5)&#123;</span><br><span class="line">    fs.writeFileSync(&apos;./db&apos;,newAmount)</span><br><span class="line">    response.setHeader(&apos;Content-Type&apos;,&apos;image/jpg&apos;)</span><br><span class="line">    //返回图片，状态码 200 成功</span><br><span class="line">    response.statusCode = 200</span><br><span class="line">    //需要真的传一张图片才能成功</span><br><span class="line">    response.write(fs.readFileSync(&apos;./dog.jpg&apos;))</span><br><span class="line"> &#125;else&#123;</span><br><span class="line">    //状态码 400 页面显示失败</span><br><span class="line">    response.statusCode = 400</span><br><span class="line">    response.write(&apos;fail&apos;)</span><br><span class="line"> &#125;</span><br><span class="line"> response.end()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>点击打钱按钮，若随机数大于0.5，则状态码显示200.并且返回dog.jpg，alert 打钱成功，点击确定，余额自动减一且页面不刷新。<br><img src="https://upload-images.jianshu.io/upload_images/7094266-8f026f51f1be16ab.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>缺点是这种办法不支持post请求，只能是get请求</p>
<p>2.用 script 造 get 请求<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;h5&gt;您的余额是</span><br><span class="line">  &lt;span id=&quot;amount&quot;&gt;&amp;&amp;&amp;amount&amp;&amp;&amp;&lt;/span&gt;</span><br><span class="line">&lt;/h5&gt;</span><br><span class="line">&lt;button id=&quot;button&quot;&gt;打钱&lt;/button&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">  button.addEventListener(&apos;click&apos;, (e) =&gt; &#123;</span><br><span class="line">    let script = document.createElement(&apos;script&apos;)</span><br><span class="line">    script.src = &apos;/pay&apos;</span><br><span class="line">    //一定要把script放入body中，才有效</span><br><span class="line">    document.body.appendChild(script)</span><br><span class="line">  // script.onload= function()&#123;</span><br><span class="line">  //   alert(&apos;打钱成功&apos;)</span><br><span class="line">  //   amount.innerText = amount.innerText-1</span><br><span class="line">  // &#125;</span><br><span class="line">  script.onerror = function () &#123;</span><br><span class="line">    alert(&apos;打钱失败&apos;)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure></p>
<p>Node代码：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">if (path === &apos;/pay&apos;) &#123;</span><br><span class="line">    var amount = fs.readFileSync(&apos;./db&apos;, &apos;utf8&apos;)</span><br><span class="line">    var newAmount = amount - 1</span><br><span class="line">    if (Math.random() &gt; 0.5) &#123;</span><br><span class="line">      fs.writeFileSync(&apos;./db&apos;, newAmount)</span><br><span class="line">      response.setHeader(&apos;Content-Type&apos;,&apos;application/javascript&apos;)</span><br><span class="line">      response.statusCode = 200</span><br><span class="line">      //直接在 response 里 返回cuccess并且减一</span><br><span class="line">      response.write(`alert(&quot;success&quot;)</span><br><span class="line">      amount.innerText = amount.innerText-1`)</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">      response.statusCode = 400</span><br><span class="line">      response.write(&apos;fail&apos;)</span><br><span class="line">    &#125;</span><br><span class="line">    response.end()</span><br></pre></td></tr></table></figure></p>
<p>Script 请求需要放入页面中才有效，由于本身script会给页面添加效果，那何必用 onload ，直接在node端写代码。<br>这种技术叫做 <strong>SRJ （Server rendered javascript）</strong>：服务器返回 javascript ，AJAX出现前的无刷新更新页面内容的方案。<br><img src="https://upload-images.jianshu.io/upload_images/7094266-b0040fe7c5d83bd7.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="">这样已经达到和第一种方法img一样的效果，而且不用返回图片<br>一直给页面添加Script也不好，如何去除？用下面方法无论成功还是失败，script标签均去掉<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">script.onload= function(e)&#123;</span><br><span class="line">    e.currentTarget.remove()</span><br><span class="line">  &#125;</span><br><span class="line">  script.onerror = function () &#123;</span><br><span class="line">    alert(&apos;打钱失败&apos;)</span><br><span class="line">    e.currentTarget.remove()</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure></p>
<hr>
<p>本文主要用于个人学习使用<br><a href="https://www.jianshu.com/p/38a72bd0e37d" target="_blank" rel="noopener">理解JSONP 下</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://adashuai5.com/2018/07/29/实现一个-jQuery-的-API/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Zhou Yuanda">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Ada 的个人博客主页">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/07/29/实现一个-jQuery-的-API/" itemprop="url">实现一个 jQuery 的 API</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-07-29T00:01:59+08:00">
                2018-07-29
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2018/07/29/实现一个-jQuery-的-API/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="/2018/07/29/实现一个-jQuery-的-API/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  826
                </span>
              

              

              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>最近开始学习 jQuery，jQuery 是 JavaScript 最受欢迎的一个库，它让原本极不方便的JS DOM API 变得十分易用，那么它是如何做到的呢？<br>要理解jQuery原理，我们可以用现有的DOM知识尝试写一个类似jQuery的API</p>
<p><strong>首先我们写一个列表，给它加上id</strong></p>
<p><img src="https://upload-images.jianshu.io/upload_images/7094266-a1b5fa2c18276641.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p><strong>以选项3为节点，找到其兄弟节点（代码见截图）</strong></p>
<p>通过 <strong>var allChildren = item3.parentNode.children</strong>获取 <strong>item3</strong> 父节点的所以子节点，然后遍历所有子节点，选出不是 <strong>item3</strong> 的所有节点，这样就找到选项3的所以兄弟节点啦。可以 console.log一下</p>
<p>（由于array是伪数组，不能用push的方法，所以我们用到 <strong>array[array.length] = allChildren[i]</strong>的方法）</p>
<p><img src="https://upload-images.jianshu.io/upload_images/7094266-4e2f54c2e513b5ad.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>然后我们把这些代码<strong>封装</strong>一下（给个函数）</p>
<p>封装的好处有很多：给代码一个名字方便调用；<strong>形成局部变量可以避免覆盖JS原始变量（立即调用函数）</strong>等</p>
<p>给这个函数取个名字，如 getSiblings；把 item3 换成 node，这样输入任意节点都可以使用这个函数了；注意不要忘记 return</p>
<p><img src="https://upload-images.jianshu.io/upload_images/7094266-ea2f6d7eaf37ac1e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>这样我们就得到了一个函数 <strong>function getSiblings(node){}</strong></p>
<hr>
<p>现在你已经学会如何封装一个函数，让我们尝试封装函数：<strong>function addClass(node, classes){}</strong></p>
<p>现在我们要给 item3 加 class属性</p>
<p>首先我们声明一个 classes 对象，里面有 a、b、c 三个属性；<strong>同时分别给它们一个布尔值，方便 add 和 remove</strong>；遍历各个属性。</p>
<p>可以看到，class b、c已经被添加到 item3 中了</p>
<p><img src="https://upload-images.jianshu.io/upload_images/7094266-ab48d3fb806dae12.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>同样我们来封装一下这些代码</p>
<p><img src="https://upload-images.jianshu.io/upload_images/7094266-8fa1e7aee94ca4f9.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>现在，只要你给一个 node 和 classes 于此函数，就可以给 该节点添加 classes所包含的正确属性</p>
<h1 id="命名空间："><a href="#命名空间：" class="headerlink" title="命名空间："></a><strong>命名空间：</strong></h1><p><strong>给封装的函数一个名字，方便其他人使用，同时防止与前人命名的冲突。</strong><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">var Adadom = &#123;&#125;</span><br><span class="line">Adadom.getSiblings(node)</span><br><span class="line">Adadom.addClass(node, &#123;a: false, b: true,c:true&#125;)</span><br></pre></td></tr></table></figure></p>
<p>得到代码如下，这样做也能<strong>避免将JS 提供的DOM覆盖</strong></p>
<p><img src="https://upload-images.jianshu.io/upload_images/7094266-a8a36cf56f38cbee.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<h1 id="能不能把node-放在前面"><a href="#能不能把node-放在前面" class="headerlink" title="能不能把node 放在前面"></a>能不能把node 放在前面</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">node.getSiblings() </span><br><span class="line">node.addClass()</span><br></pre></td></tr></table></figure>
<p>方法一：扩展 Node 接口</p>
<p>直接在 Node.prototype 上加函数</p>
<p>Node 如何取到 item3？用 this ，why？把上面写成 .call 的形式，因为 <strong>this 是call 的第一个参数。</strong>那么用 this 就显而易见了</p>
<p><img src="https://upload-images.jianshu.io/upload_images/7094266-50bd8de7275ed2b6.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>但是这样太乱了，总不能所有人都在Node原型上加属性吧？所以有了方法2</p>
<p>方法二：新的接口 BetterNode</p>
<p>示例如下<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">function Node2(node)&#123; </span><br><span class="line">    return &#123; </span><br><span class="line">        element: node,</span><br><span class="line">        getSiblings: function()&#123;</span><br><span class="line">       &#125;,</span><br><span class="line">      addClass: function()&#123;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">let node =document.getElementById(&apos;x&apos;)</span><br><span class="line">let node2 = Node2(node)</span><br><span class="line">node2.getSiblings()</span><br><span class="line">node2.addClass()</span><br></pre></td></tr></table></figure></p>
<p><img src="https://upload-images.jianshu.io/upload_images/7094266-9eb49bb5f7b83c3e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>这种方法叫做「无侵入」即对 Node 无侵入</p>
<h1 id="把-Node2-改成jQuery吧"><a href="#把-Node2-改成jQuery吧" class="headerlink" title="把 Node2 改成jQuery吧"></a>把 Node2 改成jQuery吧</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">function jQuery(node)&#123; </span><br><span class="line">    return &#123;</span><br><span class="line">        element: node,</span><br><span class="line">        getSiblings: function()&#123;</span><br><span class="line">        &#125;,</span><br><span class="line">        addClass: function()&#123;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">&#125;</span><br><span class="line">let node =document.getElementById(&apos;x&apos;)</span><br><span class="line">let node2 =jQuery(node)</span><br><span class="line">node2.getSiblings()</span><br><span class="line">node2.addClass()</span><br></pre></td></tr></table></figure>
<h1 id="再给个缩写吧-alias"><a href="#再给个缩写吧-alias" class="headerlink" title="再给个缩写吧:alias"></a>再给个缩写吧:alias</h1><p><strong>window.$ = jQuery</strong></p>
<p>即 <strong>var node2 = $(node)</strong></p>
<p>但是为了防止记混 node2 到底有没有引入 jQuery</p>
<p>大家通常这样写<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">var $node2 = $(node)</span><br></pre></td></tr></table></figure></p>
<p>至此，你已经知道 jQuery 是个什么了：它就是一个函数，是 JS 原始 DOM的扩展，便于我们更好得使用JS写代码的加强版 DOM API。</p>
<p>完整代码见 <a href="https://github.com/Adashuai5/jQuery-demo/tree/master/jQuery%20API" target="_blank" rel="noopener">github</a></p>
<hr>
<p>本文主要用于个人学习使用</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://adashuai5.com/2018/07/16/恢复github上不显示的绿块/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Zhou Yuanda">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Ada 的个人博客主页">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/07/16/恢复github上不显示的绿块/" itemprop="url">恢复github上不显示的绿块</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-07-16T00:50:39+08:00">
                2018-07-16
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2018/07/16/恢复github上不显示的绿块/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="/2018/07/16/恢复github上不显示的绿块/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  392
                </span>
              

              

              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>github 是一个良好的记录自己代码的git版本控制平台，看到自己有关的 contributions 的小绿块是件开心的事。但是如果，你的每次 commit 都没有相应的小绿块，是不是很伤感呢。</p>
<p>之前我的 github 一直存在这个问题，虽然写代码不是为了说有这个小绿块。但是没有的话，commit 的积极性会大受打击。</p>
<p>最后 google 终于找到了解决方法，原来我 github 绑定的是qq邮箱，而 git bash 上保存的 email 地址是谷歌邮箱。（其实之前也搜索到这些答案，但是由于确信当时使用的是谷歌邮箱而一直没有去看，当然或许是没想到。）</p>
<p>方法是在github 的 settings 里 Emails 中 Add 你一直错用的邮箱，这样小绿块就回来了，开心，以后又可以愉快得commit 了</p>
<p><img src="https://upload-images.jianshu.io/upload_images/7094266-4913eaff0e17eecc.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>注意只有你的终端里绑定的邮箱有效，上面的方法才可行，即你的小绿块记录会回来；如果你用的是无效邮箱，那就只能改终端绑定邮箱为github上邮箱来让未来的小绿块不丢失了（或许还有别的找回无效邮箱提交commit小绿块的方法，我不知道）有关教程可看我提供参考链接</p>
<hr>
<p>本文主要用于个人学习使用，也希望能帮到你</p>
<p>参考：</p>
<p><a href="https://blog.csdn.net/Cloudox_/article/details/50284193" target="_blank" rel="noopener">解决提交到GitHub首页不显示的问题</a></p>
<p><a href="https://www.cnblogs.com/dongliu/p/5782329.html" target="_blank" rel="noopener">解决github提交commit,contributions不统计显示绿色的问题</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://adashuai5.com/2018/07/12/JavaScript原型和原型链/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Zhou Yuanda">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Ada 的个人博客主页">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/07/12/JavaScript原型和原型链/" itemprop="url">JavaScript原型和原型链</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-07-12T00:51:42+08:00">
                2018-07-12
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2018/07/12/JavaScript原型和原型链/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="/2018/07/12/JavaScript原型和原型链/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  717
                </span>
              

              

              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>JavaScript中除了基本类型外的数据类型，都是对象。但是由于其没有 类（class，ES6引入了class，但其只是语法糖）的概念，如何将所有对象联系起来就成立一个问题，于是就有了原型和原型链的概念。</p>
<hr>
<blockquote>
<p>每个实例对象（object ）都有一个私有属性（称之为 <strong>proto</strong>）指向它的原型对象（prototype）。该原型对象也有一个自己的原型对象 ，层层向上直到一个对象的原型对象为 null。根据定义，null 没有原型，并作为这个原型链中的最后一个环节。</p>
</blockquote>
<p><img src="https://upload-images.jianshu.io/upload_images/7094266-c9e28000b43ca445.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>上面是<a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Inheritance_and_the_prototype_chain" target="_blank" rel="noopener">MDN里有关原型链知识</a>的摘录，什么意思？让我们来解释一下</p>
<p>事实上 JavaScript 所有数据都可以以对象的形式表现：由于函数是对象，我们可以用构造函数的方法使得 Number、Boolean、String变成对象。</p>
<p>下面以 Number 为例 （其他类型也一样）</p>
<p>可以用 var 基本类型 = new 对应基本类型的函数() 的方法创建一个新函数</p>
<p>var n = new Number() 创建一个 Number 函数，其是一个对象</p>
<p><img src="https://upload-images.jianshu.io/upload_images/7094266-62536de6cd21ab12.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image"></p>
<p>这里的 n 就是 Number 的实例，可以看到 n 里面有一个 <strong>proto</strong> 指向 Number() 这个函数，Number() 即为 n 的原型对象(prototype) ；</p>
<p>而 Number() 函数有一个 <strong>proto</strong> 指向 Object() 函数 ，Object() 即为 Number() 的原型对象；</p>
<p>Object() 函数里存在 hasOwnProrerty 证明其已经到达最后的属性层，再往后就是对象的最终原型对象 null。</p>
<p>即</p>
<p><img src="https://upload-images.jianshu.io/upload_images/7094266-fc991a402727ca56.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p><strong>以上一整个原型与原型层层相链接的过程即为原型链</strong></p>
<p>其可以将公用属性存放在同一原型层中，实现共享、节省内存空间等。</p>
<blockquote>
<p>当您访问实例的属性时，JavaScript首先会检查它们是否直接存在于该对象上，如果不存在，则会[[Prototype]]中查找。这意味着你在prototype中定义的所有内容都可以由所有实例有效共享，你甚至可以稍后更改部分prototype，并在所有现有实例中显示更改（如果需要）。</p>
</blockquote>
<hr>
<p>通过以上例子我们可以得到下面两个“公式”</p>
<p><strong>var 对象 = new 函数()</strong></p>
<p><strong>对象.<strong>proto</strong> === 对象的构造函数.prototype</strong></p>
<p>我们已经知道</p>
<p><strong>var n = new Number()</strong></p>
<p><strong>n.<strong>proto</strong> === Number.prototype //true</strong></p>
<p>那么 <strong>Number.<strong>proto</strong></strong> ？</p>
<p>Number 的原型对象是Function，即 Number 是 Function 的实例</p>
<p>即有 <strong>Number.<strong>proto</strong> === Function.prototype</strong></p>
<p>那么同理</p>
<p><strong>var object = new Object()</strong></p>
<p><strong>object.<strong>proto</strong> === Object.prototype</strong></p>
<p><strong>Object.<strong>proto</strong> === Function.prototype</strong></p>
<p>再进一步推断</p>
<p><strong>var function = new Function()</strong> </p>
<p><strong>function.<strong>proto</strong> === Function.prototype</strong></p>
<p><strong>Function.<strong>proto</strong> === Function.prototype</strong></p>
<p><img src="https://upload-images.jianshu.io/upload_images/7094266-b6a6447f260e8db4.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image"></p>
<hr>
<p>本文主要用于个人学习使用，如有侵权请联系我删除。</p>
<p>参考及推荐：</p>
<p><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Inheritance_and_the_prototype_chain" target="_blank" rel="noopener">继承与原型链</a></p>
<p><a href="http://www.ruanyifeng.com/blog/2011/06/designing_ideas_of_inheritance_mechanism_in_javascript.html" target="_blank" rel="noopener">Javascript继承机制的设计思想</a></p>
<p><a href="https://juejin.im/post/599d69fc6fb9a0248f4a7b31" target="_blank" rel="noopener">白话原型和原型链</a></p>
<p><a href="https://github.com/mqyqingfeng/Blog/issues/2" target="_blank" rel="noopener">JavaScript深入之从原型到原型链 #2</a></p>
<p><a href="http://book.jirengu.com/fe/%E5%89%8D%E7%AB%AF%E8%BF%9B%E9%98%B6/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/%E5%8E%9F%E5%9E%8B%E4%B8%8E%E5%8E%9F%E5%9E%8B%E9%93%BE.html" target="_blank" rel="noopener">饥人谷课件-原型链和继承</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://adashuai5.com/2018/06/22/CSS常用布局学习/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Zhou Yuanda">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Ada 的个人博客主页">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/06/22/CSS常用布局学习/" itemprop="url">CSS常用布局学习</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-06-22T22:35:31+08:00">
                2018-06-22
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2018/06/22/CSS常用布局学习/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="/2018/06/22/CSS常用布局学习/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  858
                </span>
              

              

              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>最近开始学习CSS，了解了一些基础和常规写法。CSS的知识十分复杂，是值得不断发掘和完善的一个前端模块。对于新人来说，最好的方法就是尝试，去模仿，遇到问题再去深入，一点一点得增加对CSS的基础的理解。</p>
<p>CSS布局对于新人来说，是一个比较基础的难点，首先我们应该理解一些常用的布局属性</p>
<p><a href="http://zh.learnlayout.com/" target="_blank" rel="noopener">学习CSS布局</a> 通过这以网站，学习<strong>‘display’</strong>，<strong>‘position’</strong> 以及 <strong>‘float’ </strong>等属性，加深对其认识。</p>
<p><img src="https://upload-images.jianshu.io/upload_images/7094266-da5183cded1d63d5.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<hr>
<p>下面介绍几种常用的布局方法</p>
<h1 id="1-左右布局"><a href="#1-左右布局" class="headerlink" title="1.左右布局"></a>1.左右布局</h1><p>1.1.用 <strong>‘float’ </strong>实现左右布局</p>
<p><img src="https://upload-images.jianshu.io/upload_images/7094266-36b825766bb976e4.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>只要设定两个布局块的宽度总和为 ‘<strong>container’(容器) </strong>的宽，那么俩个class的float属性可均为 <strong>‘float:left;’ </strong></p>
<p>也可以用以下方法让右边块级元素自适应左边达到左右布局</p>
<p><img src="https://upload-images.jianshu.io/upload_images/7094266-95e2ada432bbbcee.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>即给 <strong>‘right’</strong> 的宽度加上 <strong>‘margin-left’</strong></p>
<p>1.2.用<strong> ‘position’ </strong>实现左右布局</p>
<p><img src="https://upload-images.jianshu.io/upload_images/7094266-5711c22ce85c4def.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>父元素设置为<strong>position:relative;</strong></p>
<p>left设置固定宽度，设定为<strong>绝对定位’position:absolute’</strong>。</p>
<p>right设置为<strong>相对定位’position:relative’</strong>。</p>
<p>right设置左边距，<strong>‘margin-left’ </strong>为左侧栏的宽度。</p>
<h1 id="2-左中右布局"><a href="#2-左中右布局" class="headerlink" title="2.左中右布局"></a>2.左中右布局</h1><p>2.1.用 <strong>‘float’ </strong>实现左右布局</p>
<p><img src="https://upload-images.jianshu.io/upload_images/7094266-4af2cbc2a81b81ff.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>其原理与 <strong>‘float’ </strong>左右布局一样，且也可以用自适应。</p>
<p>值得注意的是 <strong>‘middle’ </strong>所在块与 <strong>‘left’ </strong>所在块一样，要用 <strong>‘float:left;’ </strong></p>
<p>而 <strong>‘right’</strong> 所在块可以用 <strong>‘float:left’</strong> 或 <strong>‘float:right;’</strong> 以及自适应。</p>
<p>2.2.用<strong> ‘position’ </strong>实现左中右布局</p>
<p><img src="https://upload-images.jianshu.io/upload_images/7094266-83bd3380ae9c53c6.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>原理与前面类似，值得注意的是，我们要调整一下html的布局，保证 <strong>‘right’ </strong>列div在 <strong>‘middle’ </strong>列div前，不然会出现第三块换行显示的情况，此问题涉及<strong>文档流</strong></p>
<p><strong>文档流：</strong>文档内元素的流动方向：内联元素从左往右，宽度不够另起一行继续；块级元素，每一块占一行，从上到下依次往下</p>
<p>所以同理，2.1.中<strong>‘middle’ </strong>若用自适应，也要调整html与上面一样</p>
<h1 id="3-水平居中"><a href="#3-水平居中" class="headerlink" title="3.水平居中"></a>3.水平居中</h1><p>其实前面已经用到了水平居中的方法</p>
<p><strong>margin: 0 auto;</strong> 常用于块级元素</p>
<p><img src="https://upload-images.jianshu.io/upload_images/7094266-467bc19891cc934f.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>当然还有其他水平居中及垂直居中的方法，网上有很多相关博客。如<a href="http://louiszhai.github.io/2016/03/12/css-center/" target="_blank" rel="noopener">16种方法实现水平居中垂直居中</a></p>
<hr>
<p>另外，如何实现将垂直元素变成水平，也可以用<strong>‘float:left;’</strong></p>
<p>方法如下：</p>
<p>1.给所有的子元素加 <strong>float:left</strong></p>
<p><img src="https://upload-images.jianshu.io/upload_images/7094266-ef4aadee77723993.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p>2.给父元素加 <strong>clearfix 类 </strong>（其目的是去掉<strong>float:left </strong>产生的bug，一定会有bug，因此一定要加上）</p>
<p><img src="https://upload-images.jianshu.io/upload_images/7094266-d7be5e5d7ed3302e.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<p><strong>clearfix 类</strong>写法如下</p>
<p><img src="https://upload-images.jianshu.io/upload_images/7094266-0b746da3ed8fa6cb.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p>
<hr>
<p>通过上述知识，相信你对<strong>‘display’</strong>，<strong>‘position’</strong> 以及 <strong>‘float’</strong> 等属性已经有所认识。后续学习过程中了解了 <strong>‘flex’</strong>属性（其实<a href="https://link.zhihu.com/?target=http%3A//zh.learnlayout.com/toc.html" target="_blank" rel="noopener">学习CSS布局</a>里提到了，有兴趣可以看MDN文档，但是看文档很多时候不能快速理解）推荐看看大佬们的博客，这里推荐阮一峰老师关于<strong>‘flex’布局</strong>的<a href="http://www.ruanyifeng.com/blog/2015/07/flex-grammar.html" target="_blank" rel="noopener">博客</a>，上述1，2种布局方式现已经不提倡，<strong>‘flex’</strong>是个强大的属性，<strong>‘flex’布局</strong>应作为布局的首选。</p>
<p>本文主要用于个人学习使用，如有侵权请联系我删除</p>
<p>主要参考：</p>
<p><a href="http://zh.learnlayout.com/toc.html" target="_blank" rel="noopener">学习CSS布局</a></p>
<p><a href="https://leohxj.gitbooks.io/front-end-database/html-and-css-basic/css-layout.html" target="_blank" rel="noopener">CSS常见布局</a></p>
<p><a href="https://www.jianshu.com/p/c6673f8a6a5a" target="_blank" rel="noopener">DIV+CSS页面基本布局总结</a></p>
<p><a href="http://louiszhai.github.io/2016/03/12/css-center/" target="_blank" rel="noopener">16种方法实现水平居中垂直居中</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/3/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image" src="/images/avatar.png" alt="Zhou Yuanda">
            
              <p class="site-author-name" itemprop="name">Zhou Yuanda</p>
              <p class="site-description motion-element" itemprop="description">当然我也在扯淡。。</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">28</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            

            

          </nav>

          
            <div class="feed-link motion-element">
              <a href="/rss2.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/Adashuai5" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i>GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://www.zhihu.com/people/zhouyuanda/activities" target="_blank" title="知乎">
                      
                        <i class="fa fa-fw fa-gratipay"></i>知乎</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://twitter.com/zhouyuanda" target="_blank" title="Twitter">
                      
                        <i class="fa fa-fw fa-twitter"></i>Twitter</a>
                  </span>
                
            </div>
          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Zhou Yuanda</span>

  
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-area-chart"></i>
    </span>
    
      <span class="post-meta-item-text">Site words total count&#58;</span>
    
    <span title="Site words total count">29.5k</span>
  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Muse</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  


  











  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  

  
  
    <script type="text/javascript" src="/lib/canvas-nest/canvas-nest.min.js"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  










  <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
  <script src="//unpkg.com/valine/dist/Valine.min.js"></script>
  
  <script type="text/javascript">
    var GUEST = ['nick','mail','link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(item=>{
      return GUEST.indexOf(item)>-1;
    });
    new Valine({
        el: '#comments' ,
        verify: false,
        notify: false,
        appId: 'rCHTUodUQxhggekUOHOTeWkS-gzGzoHsz',
        appKey: 'ekqWCAPWHp5Ioq6vrzC1foPT',
        placeholder: 'Just go go',
        avatar:'mm',
        guest_info:guest,
        pageSize:'10' || 10,
    });
  </script>



  





  

  

  

  
  

  

  

  

</body>
</html>
